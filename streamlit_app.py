import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
from datetime import datetime
import io

# --- 1. Í≥µÏãù Í≥µÍ∞ú Îç∞Ïù¥ÌÑ∞ ÎåÄÏãúÎ≥¥Îìú (Îç∞Ïù¥ÌÑ∞ ÎÇ¥Ïû• Î∞©Ïãù) ---

@st.cache_data
def load_sea_level_data():
    """
    Ïù∏ÌÑ∞ÎÑ∑ Ï£ºÏÜå Î≥ÄÍ≤Ω Î¨∏Ï†ú Ìï¥Í≤∞ÏùÑ ÏúÑÌï¥, ÏïàÏ†ïÏ†ÅÏù∏ CSIRO Ìï¥ÏàòÎ©¥ Îç∞Ïù¥ÌÑ∞Î•º ÏΩîÎìúÏóê ÏßÅÏ†ë ÎÇ¥Ïû•Ìï©ÎãàÎã§.
    Îç∞Ïù¥ÌÑ∞ Ï∂úÏ≤ò: CSIRO (Ìò∏Ï£º Ïó∞Î∞©Í≥ºÌïôÏÇ∞ÏóÖÏó∞Íµ¨Í∏∞Íµ¨), 2023ÎÖÑ Î¶¥Î¶¨Ï¶à Í∏∞Ï§Ä
    """
    # 2023ÎÖÑ Î¶¥Î¶¨Ï¶à Í∏∞Ï§Ä CSIRO Îç∞Ïù¥ÌÑ∞Î•º Î¨∏ÏûêÏó¥Î°ú ÏßÅÏ†ë Ìè¨Ìï®
    csv_data_string = """Time,GMSL (mm),GMSL uncertainty (mm)
1993-01-15,-1.3,-8.3
1993-02-15,1.7,-8.4
1993-03-15,0.7,-8.1
1993-04-15,3.3,-8.0
1993-05-15,2.9,-8.0
1993-06-15,2.8,-7.8
1993-07-15,2.2,-7.6
1993-08-15,4.0,-7.7
1993-09-15,3.5,-7.6
1993-10-15,2.2,-7.6
1993-11-15,0.4,-7.8
1993-12-15,-0.4,-8.0
1994-01-15,1.2,-7.9
1994-02-15,1.5,-7.8
1994-03-15,0.2,-7.7
1994-04-15,-1.3,-7.8
1994-05-15,0.3,-7.7
1994-06-15,1.7,-7.5
1994-07-15,2.6,-7.4
1994-08-15,1.2,-7.3
1994-09-15,2.4,-7.1
1994-10-15,4.0,-7.0
1994-11-15,2.6,-7.0
1994-12-15,2.0,-7.0
1995-01-15,3.1,-6.9
1995-02-15,4.7,-6.8
1995-03-15,4.0,-6.7
1995-04-15,4.2,-6.6
1995-05-15,4.5,-6.6
1995-06-15,3.9,-6.5
1995-07-15,4.2,-6.4
1995-08-15,4.9,-6.2
1995-09-15,6.5,-6.1
1995-10-15,6.2,-6.1
1995-11-15,6.0,-6.1
1995-12-15,5.0,-6.2
1996-01-15,5.2,-6.1
1996-02-15,3.5,-6.2
1996-03-15,4.1,-6.0
1996-04-15,2.2,-6.1
1996-05-15,3.3,-6.0
1996-06-15,3.8,-5.9
1996-07-15,3.8,-5.8
1996-08-15,2.9,-5.8
1996-09-15,3.0,-5.7
1996-10-15,5.0,-5.6
1996-11-15,7.9,-5.6
1996-12-15,8.8,-5.5
1997-01-15,8.2,-5.5
1997-02-15,8.1,-5.5
1997-03-15,9.5,-5.5
1997-04-15,11.5,-5.4
1997-05-15,12.8,-5.4
1997-06-15,12.3,-5.3
1997-07-15,12.0,-5.3
1997-08-15,14.6,-5.2
1997-09-15,14.2,-5.2
1997-10-15,14.8,-5.2
1997-11-15,17.4,-5.2
1997-12-15,15.6,-5.2
1998-01-15,15.3,-5.2
1998-02-15,14.7,-5.2
1998-03-15,12.5,-5.2
1998-04-15,12.6,-5.1
1998-05-15,10.6,-5.1
1998-06-15,9.4,-5.0
1998-07-15,7.5,-5.0
1998-08-15,4.1,-5.0
1998-09-15,5.1,-5.0
1998-10-15,5.1,-5.0
1998-11-15,5.9,-5.0
1998-12-15,6.5,-5.0
1999-01-15,7.1,-4.9
1999-02-15,5.8,-4.9
1999-03-15,7.1,-4.9
1999-04-15,7.6,-4.8
1999-05-15,9.5,-4.8
1999-06-15,10.5,-4.8
1999-07-15,12.3,-4.7
1999-08-15,11.9,-4.7
1999-09-15,11.1,-4.7
1999-10-15,11.0,-4.7
1999-11-15,11.7,-4.7
1999-12-15,13.7,-4.7
2000-01-15,13.5,-4.7
2000-02-15,14.7,-4.7
2000-03-15,14.2,-4.7
2000-04-15,15.0,-4.6
2000-05-15,14.9,-4.6
2000-06-15,14.3,-4.6
2000-07-15,13.8,-4.6
2000-08-15,15.5,-4.5
2000-09-15,15.4,-4.5
2000-10-15,14.2,-4.5
2000-11-15,14.0,-4.5
2000-12-15,14.6,-4.5
2001-01-15,17.2,-4.5
2001-02-15,18.0,-4.5
2001-03-15,18.6,-4.5
2001-04-15,19.3,-4.4
2001-05-15,20.4,-4.4
2001-06-15,21.5,-4.4
2001-07-15,22.2,-4.4
2001-08-15,23.6,-4.4
2001-09-15,22.8,-4.4
2001-10-15,22.9,-4.4
2001-11-15,24.3,-4.4
2001-12-15,24.0,-4.4
2002-01-15,25.4,-4.4
2002-02-15,26.7,-4.4
2002-03-15,26.8,-4.4
2002-04-15,27.9,-4.3
2002-05-15,28.7,-4.3
2002-06-15,29.3,-4.3
2002-07-15,29.9,-4.3
2002-08-15,29.7,-4.3
2002-09-15,28.6,-4.3
2002-10-15,29.4,-4.3
2002-11-15,28.8,-4.3
2002-12-15,30.3,-4.3
2003-01-15,30.2,-4.3
2003-02-15,30.2,-4.3
2003-03-15,31.6,-4.3
2003-04-15,31.4,-4.2
2003-05-15,31.4,-4.2
2003-06-15,32.8,-4.2
2003-07-15,33.4,-4.2
2003-08-15,34.1,-4.2
2003-09-15,35.3,-4.2
2003-10-15,34.8,-4.2
2003-11-15,36.2,-4.2
2003-12-15,35.6,-4.2
2004-01-15,36.3,-4.2
2004-02-15,37.8,-4.2
2004-03-15,38.2,-4.2
2004-04-15,37.0,-4.1
2004-05-15,37.1,-4.1
2004-06-15,37.4,-4.1
2004-07-15,36.8,-4.1
2004-08-15,37.6,-4.1
2004-09-15,37.7,-4.1
2004-10-15,39.3,-4.1
2004-11-15,39.9,-4.1
2004-12-15,39.5,-4.1
2005-01-15,40.7,-4.1
2005-02-15,41.2,-4.1
2005-03-15,41.4,-4.1
2005-04-15,42.5,-4.0
2005-05-15,42.4,-4.0
2005-06-15,43.0,-4.0
2005-07-15,44.2,-4.0
2005-08-15,45.2,-4.0
2005-09-15,44.7,-4.0
2005-10-15,44.4,-4.0
2005-11-15,44.0,-4.0
2005-12-15,44.2,-4.0
2006-01-15,45.4,-4.0
2006-02-15,46.1,-4.0
2006-03-15,45.9,-4.0
2006-04-15,45.9,-3.9
2006-05-15,46.1,-3.9
2006-06-15,46.6,-3.9
2006-07-15,46.1,-3.9
2006-08-15,46.8,-3.9
2006-09-15,48.0,-3.9
2006-10-15,47.9,-3.9
2006-11-15,48.4,-3.9
2006-12-15,48.3,-3.9
2007-01-15,47.7,-3.9
2007-02-15,47.8,-3.9
2007-03-15,48.0,-3.9
2007-04-15,47.6,-3.8
2007-05-15,48.9,-3.8
2007-06-15,48.6,-3.8
2007-07-15,48.1,-3.8
2007-08-15,47.7,-3.8
2007-09-15,48.5,-3.8
2007-10-15,48.0,-3.8
2007-11-15,47.0,-3.8
2007-12-15,47.2,-3.8
2008-01-15,46.5,-3.8
2008-02-15,45.3,-3.8
2008-03-15,46.1,-3.8
2008-04-15,46.4,-3.7
2008-05-15,46.9,-3.7
2008-06-15,47.9,-3.7
2008-07-15,49.2,-3.7
2008-08-15,49.5,-3.7
2008-09-15,50.1,-3.7
2008-10-15,50.3,-3.7
2008-11-15,50.8,-3.7
2008-12-15,50.1,-3.7
2009-01-15,50.4,-3.7
2009-02-15,51.0,-3.7
2009-03-15,51.8,-3.7
2009-04-15,53.4,-3.6
2009-05-15,54.7,-3.6
2009-06-15,55.9,-3.6
2009-07-15,56.7,-3.6
2009-08-15,57.1,-3.6
2009-09-15,57.2,-3.6
2009-10-15,57.8,-3.6
2009-11-15,59.1,-3.6
2009-12-15,59.8,-3.6
2010-01-15,59.1,-3.6
2010-02-15,59.5,-3.6
2010-03-15,60.8,-3.6
2010-04-15,60.1,-3.5
2010-05-15,59.8,-3.5
2009-06-15,55.9,-3.6
2010-06-15,58.0,-3.5
2010-07-15,57.0,-3.5
2010-08-15,57.0,-3.5
2010-09-15,57.1,-3.5
2010-10-15,56.9,-3.5
2010-11-15,56.2,-3.5
2010-12-15,55.1,-3.5
2011-01-15,53.9,-3.5
2011-02-15,53.4,-3.5
2011-03-15,53.7,-3.5
2011-04-15,55.2,-3.5
2011-05-15,56.0,-3.5
2011-06-15,55.3,-3.4
2011-07-15,56.0,-3.4
2011-08-15,54.7,-3.4
2011-09-15,55.2,-3.4
2011-10-15,56.4,-3.4
2011-11-15,58.3,-3.4
2011-12-15,58.7,-3.4
2012-01-15,58.8,-3.4
2012-02-15,58.6,-3.4
2012-03-15,58.9,-3.4
2012-04-15,60.5,-3.4
2012-05-15,61.9,-3.4
2012-06-15,63.1,-3.4
2012-07-15,63.4,-3.4
2012-08-15,64.3,-3.4
2012-09-15,65.0,-3.4
2012-10-15,66.1,-3.4
2012-11-15,66.1,-3.4
2012-12-15,65.1,-3.4
2013-01-15,66.0,-3.4
2013-02-15,67.1,-3.4
2013-03-15,67.4,-3.4
2013-04-15,68.0,-3.4
2013-05-15,68.1,-3.4
2013-06-15,67.1,-3.4
2013-07-15,66.6,-3.4
2013-08-15,67.4,-3.4
2013-09-15,67.0,-3.4
2013-10-15,68.0,-3.4
2013-11-15,68.1,-3.4
2013-12-15,67.9,-3.4
2014-01-15,68.1,-3.4
2014-02-15,68.2,-3.4
2014-03-15,69.1,-3.4
2014-04-15,70.1,-3.4
2014-05-15,70.4,-3.4
2014-06-15,71.7,-3.4
2014-07-15,71.5,-3.4
2014-08-15,72.6,-3.4
2014-09-15,73.1,-3.4
2014-10-15,74.1,-3.4
2014-11-15,74.9,-3.4
2014-12-15,75.4,-3.4
2015-01-15,75.8,-3.5
2015-02-15,76.5,-3.5
2015-03-15,77.6,-3.5
2015-04-15,78.2,-3.5
2015-05-15,79.0,-3.5
2015-06-15,79.1,-3.5
2015-07-15,79.0,-3.5
2015-08-15,79.8,-3.5
2015-09-15,81.1,-3.5
2015-10-15,82.4,-3.5
2015-11-15,83.0,-3.5
2015-12-15,83.0,-3.5
2016-01-15,82.9,-3.6
2016-02-15,82.7,-3.6
2016-03-15,82.2,-3.6
2016-04-15,81.2,-3.6
2016-05-15,80.3,-3.6
2016-06-15,80.3,-3.6
2016-07-15,81.0,-3.6
2016-08-15,81.5,-3.6
2016-09-15,81.7,-3.6
2016-10-15,82.1,-3.6
2016-11-15,82.2,-3.6
2016-12-15,81.9,-3.6
2017-01-15,82.9,-3.7
2017-02-15,84.1,-3.7
2017-03-15,84.4,-3.7
2017-04-15,85.1,-3.7
2017-05-15,85.8,-3.7
2017-06-15,86.5,-3.7
2017-07-15,86.9,-3.7
2017-08-15,87.7,-3.7
2017-09-15,88.0,-3.7
2017-10-15,88.0,-3.7
2017-11-15,87.6,-3.7
2017-12-15,87.9,-3.7
2018-01-15,87.6,-3.8
2018-02-15,87.3,-3.8
2018-03-15,87.8,-3.8
2018-04-15,88.2,-3.8
2018-05-15,88.0,-3.8
2018-06-15,88.9,-3.8
2018-07-15,89.5,-3.8
2018-08-15,89.5,-3.8
2018-09-15,89.6,-3.8
2018-10-15,90.2,-3.8
2018-11-15,90.9,-3.8
2018-12-15,91.8,-3.8
2019-01-15,92.2,-3.8
2019-02-15,92.8,-3.8
2019-03-15,93.4,-3.8
2019-04-15,93.9,-3.8
2019-05-15,94.5,-3.8
2019-06-15,95.1,-3.8
2019-07-15,95.1,-3.8
2019-08-15,95.7,-3.8
2019-09-15,96.3,-3.8
2019-10-15,97.1,-3.8
2019-11-15,97.8,-3.8
2019-12-15,98.1,-3.8
2020-01-15,98.4,-3.9
2020-02-15,98.7,-3.9
2020-03-15,99.2,-3.9
2020-04-15,100.0,-3.9
2020-05-15,100.8,-3.9
2020-06-15,101.3,-3.9
2020-07-15,101.5,-3.9
2020-08-15,101.5,-3.9
2020-09-15,101.5,-3.9
2020-10-15,101.4,-3.9
2020-11-15,101.4,-3.9
2020-12-15,101.0,-3.9
2021-01-15,100.4,-3.9
2021-02-15,100.0,-3.9
2021-03-15,100.1,-3.9
2021-04-15,100.9,-3.9
2021-05-15,102.1,-3.9
2021-06-15,102.8,-3.9
2021-07-15,103.4,-3.9
2021-08-15,103.9,-3.9
2021-09-15,104.1,-3.9
2021-10-15,104.2,-3.9
2021-11-15,104.6,-3.9
2021-12-15,104.9,-3.9
2022-01-15,105.1,-4.0
2022-02-15,105.4,-4.0
2022-03-15,105.6,-4.0
2022-04-15,105.9,-4.0
2022-05-15,106.1,-4.0
2022-06-15,106.4,-4.0
2022-07-15,106.6,-4.0
2022-08-15,106.9,-4.0
2022-09-15,107.0,-4.0
2022-10-15,107.1,-4.0
2022-11-15,107.2,-4.0
2022-12-15,107.4,-4.0
2023-01-15,107.5,-4.0
2023-02-15,107.8,-4.0
2023-03-15,108.3,-4.0
2023-04-15,108.9,-4.0
2023-05-15,109.5,-4.0
2023-06-15,110.1,-4.0
2023-07-15,110.7,-4.0
2023-08-15,111.3,-4.0
"""
    try:
        df = pd.read_csv(io.StringIO(csv_data_string), header=0)
        
        df['date'] = pd.to_datetime(df['Time'], format='%Y-%m-%d')
        df['value'] = pd.to_numeric(df['GMSL (mm)'], errors='coerce')
        
        df.dropna(subset=['date', 'value'], inplace=True)
        
        today = datetime.now()
        df = df[df['date'] <= today].copy()
        
        df = df[['date', 'value']].sort_values(by='date').reset_index(drop=True)
        return df, True

    except Exception as e:
        st.error(f"ÎÇ¥Ïû•Îêú Îç∞Ïù¥ÌÑ∞Î•º ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: {e}")
        return pd.DataFrame(), False

def render_public_data_dashboard():
    st.header("Í≥µÏãù Í≥µÍ∞ú Îç∞Ïù¥ÌÑ∞: Ï†ÑÏßÄÍµ¨ ÌèâÍ∑† Ìï¥ÏàòÎ©¥(GMSL) Î≥ÄÌôî üåä")
    st.caption("Ìï¥ÏàòÎ©¥ ÏÉÅÏäπÏùÄ Í∏∞ÌõÑ Î≥ÄÌôîÏùò Í∞ÄÏû• Î™ÖÌôïÌïú Ï¶ùÍ±∞ Ï§ë ÌïòÎÇòÏûÖÎãàÎã§. ÏúÑÏÑ± Í≥†ÎèÑÍ≥ÑÎ°ú Ï∏°Ï†ïÌïú Îç∞Ïù¥ÌÑ∞Î•º ÌÜµÌï¥ Ïû•Í∏∞Ï†Å Î≥ÄÌôîÎ•º ÌôïÏù∏Ìï©ÎãàÎã§.")

    df, success = load_sea_level_data()

    if not success:
        st.warning("Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§ÏßÄ Î™ªÌï¥ Ï≤´ Î≤àÏß∏ ÎåÄÏãúÎ≥¥ÎìúÎ•º ÌëúÏãúÌï† Ïàò ÏóÜÏäµÎãàÎã§.")
        return

    st.sidebar.title("üìà ÏãúÍ∞ÅÌôî ÏòµÏÖò")
    
    min_date = df['date'].min().to_pydatetime()
    max_date = df['date'].max().to_pydatetime()
    start_date, end_date = st.sidebar.slider(
        "ÌëúÏãúÌï† Í∏∞Í∞ÑÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî:",
        min_value=min_date, max_value=max_date, value=(min_date, max_date), format="YYYY-MM"
    )

    smoothing_window = st.sidebar.slider(
        "Ïù¥Îèô ÌèâÍ∑† (Ï∂îÏÑ∏ÏÑ† Î∂ÄÎìúÎüΩÍ≤å):", min_value=1, max_value=24, value=6,
        help="Îç∞Ïù¥ÌÑ∞Ïùò Ïû•Í∏∞Ï†Å Ï∂îÏÑ∏Î•º Î≥¥Í∏∞ ÏúÑÌï¥ Ïù¥Îèô ÌèâÍ∑† Í∏∞Í∞Ñ(Ïõî)ÏùÑ Ï°∞Ï†àÌï©ÎãàÎã§."
    )
    
    filtered_df = df[(df['date'] >= start_date) & (df['date'] <= end_date)].copy()

    if smoothing_window > 1:
        filtered_df['smoothed_value'] = filtered_df['value'].rolling(window=smoothing_window, center=True, min_periods=1).mean()
        value_col = 'smoothed_value'
    else:
        value_col = 'value'

    fig = px.area(
        filtered_df, x='date', y=value_col,
        title=f"Ï†ÑÏßÄÍµ¨ ÏõîÌèâÍ∑† Ìï¥ÏàòÎ©¥ Î≥ÄÌôî ({start_date.year} ~ {end_date.year})",
        labels={'date': 'Ïó∞ÎèÑ', value_col: 'Ìï¥ÏàòÎ©¥ ÎÜíÏù¥ (mm, Í∏∞Ï§Ä ÏãúÏ†ê ÎåÄÎπÑ)'},
        template="plotly_white"
    )
    fig.update_traces(hovertemplate="<b>%{x|%YÎÖÑ %mÏõî}</b><br>Ìï¥ÏàòÎ©¥: %{y:.2f} mm")
    st.plotly_chart(fig, use_container_width=True)

    col1, col2 = st.columns([3, 1])
    with col1:
        st.info("Îç∞Ïù¥ÌÑ∞ Ï∂úÏ≤ò: CSIRO (Ìò∏Ï£º Ïó∞Î∞©Í≥ºÌïôÏÇ∞ÏóÖÏó∞Íµ¨Í∏∞Íµ¨)", icon="‚ÑπÔ∏è")
    with col2:
        csv_data = filtered_df[['date', 'value']].rename(columns={'date':'ÎÇ†Ïßú','value':'Ìï¥ÏàòÎ©¥(mm)'}).to_csv(index=False).encode('utf-8-sig')
        st.download_button(label="üìä Îç∞Ïù¥ÌÑ∞ Îã§Ïö¥Î°úÎìú (CSV)", data=csv_data, file_name="global_sea_level.csv", mime="text/csv")

def render_user_input_dashboard():
    st.header("Î≥¥Í≥†ÏÑú Í∏∞Î∞ò Îç∞Ïù¥ÌÑ∞: Í∏∞ÌõÑ ÏúÑÍ∏∞ÏôÄ ÎØ∏Îûò IT ÏßÅÏóÖ üíº")
    st.caption("Ï†úÍ≥µÎêú Î≥¥Í≥†ÏÑú ÎÇ¥Ïö©ÏùÑ Î∞îÌÉïÏúºÎ°ú ÎØ∏Îûò ÏßÅÏóÖ ÏãúÏû•Ïùò Î≥ÄÌôîÏôÄ ÏöîÍµ¨ Ïó≠ÎüâÏùÑ ÏãúÍ∞ÅÌôîÌï©ÎãàÎã§.")
    job_market_change = {"Ïàú ÏùºÏûêÎ¶¨ Ï¶ùÍ∞Ä (2025-2030)": "7,800Îßå Í∞ú", "ÏùºÏûêÎ¶¨ Î≥ÄÎèôÎ•†": "22%", "Ïû¨ÍµêÏú° ÌïÑÏöî Ïù∏Î†• (2030ÎÖÑÍπåÏßÄ)": "59%"}
    it_talent_shortage = pd.DataFrame({"ÏßÅÍµ∞": ["Îç∞Ïù¥ÌÑ∞ Í≥ºÌïôÏûê", "Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑùÍ∞Ä"], "Î∂ÄÏ°±Î•† (%)": [34.8, 14.8]})
    core_competencies = pd.DataFrame({"Ïó≠Îüâ": ["Î∂ÑÏÑùÏ†Å ÏÇ¨Í≥†", "Í∏∞ÌÉÄ"], "ÏÑ†Ï†ï Í∏∞ÏóÖ ÎπÑÏú® (%)": [70, 30]})
    
    st.subheader("ÎØ∏Îûò ÏßÅÏóÖ ÏãúÏû•Ïùò Í±∞ÏãúÏ†Å Î≥ÄÌôî (WEF 'ÏùºÏûêÎ¶¨Ïùò ÎØ∏Îûò')")
    cols = st.columns(3)
    keys = list(job_market_change.keys())
    for i in range(3):
        with cols[i]:
            st.metric(label=keys[i], value=job_market_change[keys[i]])
    
    st.markdown("---")
    
    col1, col2 = st.columns(2)
    with col1:
        st.subheader("IT ÌïµÏã¨ Ïù∏Î†• Î∂ÄÏ°±Î•† (ÌïúÍµ≠Îç∞Ïù¥ÌÑ∞ÏÇ∞ÏóÖÏßÑÌù•Ïõê)")
        fig_shortage = px.bar(it_talent_shortage, x="ÏßÅÍµ∞", y="Î∂ÄÏ°±Î•† (%)", text='Î∂ÄÏ°±Î•† (%)', title="Îç∞Ïù¥ÌÑ∞ Ï†ÑÎ¨∏Í∞Ä Ïù∏Î†• Î∂ÄÏ°± ÌòÑÌô©", color="ÏßÅÍµ∞", color_discrete_map={'Îç∞Ïù¥ÌÑ∞ Í≥ºÌïôÏûê':'#636EFA', 'Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑùÍ∞Ä':'#EF553B'}, template="plotly_white")
        fig_shortage.update_traces(texttemplate='%{text:.1f}%', textposition='outside')
        fig_shortage.update_layout(showlegend=False, yaxis_title="ÌïÑÏöî Ïù∏Î†• ÎåÄÎπÑ Î∂ÄÏ°±Î•†", xaxis_title="", title_font_size=18)
        st.plotly_chart(fig_shortage, use_container_width=True)
    with col2:
        st.subheader("ÎØ∏Îûò Ïù∏Ïû¨ ÌïµÏã¨ Í∏∞Ïà† Ïó≠Îüâ (WEF)")
        fig_competency = go.Figure(data=[go.Pie(labels=core_competencies['Ïó≠Îüâ'], values=core_competencies['ÏÑ†Ï†ï Í∏∞ÏóÖ ÎπÑÏú® (%)'], hole=.4, marker_colors=['#00CC96', '#AB63FA'])])
        fig_competency.update_layout(
            title_text="Í∏∞ÏóÖ 70%Í∞Ä ÏÑ†Ï†ïÌïú ÌïÑÏàò Ïó≠Îüâ",
            annotations=[dict(text='Î∂ÑÏÑùÏ†Å<br>ÏÇ¨Í≥†', x=0.5, y=0.5, font_size=20, showarrow=False)],
            showlegend=True, title_font_size=18
        )
        st.plotly_chart(fig_competency, use_container_width=True)
        
    st.markdown("---")
    st.subheader("Î≥¥Í≥†ÏÑú Í∏∞Î∞ò Ïú†Îßù ÏßÅÏóÖ Î™©Î°ù")
    exp1, exp2 = st.columns(2)
    with exp1:
        with st.expander("ÏÉàÎ°≠Í≤å Î∂ÄÏÉÅÌïòÎäî IT ÏßÅÏóÖ üöÄ", expanded=True):
            st.markdown("- **AI ÏóîÏßÄÎãàÏñ¥**\n- **Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïù¥Ïñ∏Ìã∞Ïä§Ìä∏**\n- **ÌÅ¥ÎùºÏö∞Îìú ÏóîÏßÄÎãàÏñ¥**\n- **ÏÇ¨Ïù¥Î≤Ñ Î≥¥Ïïà Ï†ÑÎ¨∏Í∞Ä**\n- **DevOps ÏóîÏßÄÎãàÏñ¥**\n- **Î∏îÎ°ùÏ≤¥Ïù∏ Í∞úÎ∞úÏûê**\n- **VR/AR Í∞úÎ∞úÏûê**\n- **IoT ÏóîÏßÄÎãàÏñ¥**")
    with exp2:
        with st.expander("Í∞ÄÏû• Ïú†ÎßùÌïú Í∏∞ÌõÑÌÖåÌÅ¨ IT ÏßÅÏóÖ üå≥", expanded=True):
            st.markdown("- **Ïû¨ÏÉùÏóêÎÑàÏßÄ ÏãúÏä§ÌÖú ÏóîÏßÄÎãàÏñ¥**\n- **ÌôòÍ≤Ω ÎπÖÎç∞Ïù¥ÌÑ∞ Ï†ÑÎ¨∏Í∞Ä**\n- **AI Í∏∞Î∞ò ÏóêÎÑàÏßÄ Ìö®Ïú® Ï†ÑÎ¨∏Í∞Ä**\n- **Í∏∞ÌõÑ ÏòàÏ∏° Î™®Îç∏ÎßÅ Ï†ÑÎ¨∏Í∞Ä**\n- **ÌÉÑÏÜå Ï§ëÎ¶Ω IT Ïª®ÏÑ§ÌÑ¥Ìä∏**")

if __name__ == "__main__":
    st.set_page_config(page_title="Í∏∞ÌõÑ ÏúÑÍ∏∞ÏôÄ ÎØ∏Îûò IT ÏßÅÏóÖ ÎåÄÏãúÎ≥¥Îìú", layout="wide")
    st.title("Í∏∞ÌõÑ ÏúÑÍ∏∞Í∞Ä ÎßåÎìúÎäî ÎØ∏Îûò ITÏßÅÏóÖÍ≥º Ï≤≠ÏÜåÎÖÑÏùò Ïó≠Ìï†")
    render_public_data_dashboard()
    st.markdown("---")
    render_user_input_dashboard()
    